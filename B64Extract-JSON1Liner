[System.IO.File]::WriteAllText("Extract-JSON.ps1", [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String("ZnVuY3Rpb24gRXh0cmFjdC1Kc29uQ29udGVudCB7DQogICAgW0NtZGxldEJpbmRpbmcoKV0NCiAgICBwYXJhbSAoDQogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQ0KICAgICAgICBbc3RyaW5nXSRGaWxlUGF0aCwNCiAgICAgICAgDQogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0NCiAgICAgICAgW3N0cmluZ10kT3V0cHV0UGF0aA0KICAgICkNCg0KICAgICMgQ2hlY2sgaWYgZmlsZSBleGlzdHMNCiAgICBpZiAoLW5vdCAoVGVzdC1QYXRoIC1QYXRoICRGaWxlUGF0aCkpIHsNCiAgICAgICAgV3JpdGUtRXJyb3IgIkZpbGUgbm90IGZvdW5kOiAkRmlsZVBhdGgiDQogICAgICAgIHJldHVybg0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgICMgUmVhZCB0aGUgZW50aXJlIGZpbGUgY29udGVudA0KICAgICAgICAkZmlsZUNvbnRlbnQgPSBHZXQtQ29udGVudCAtUGF0aCAkRmlsZVBhdGggLVJhdw0KDQogICAgICAgICMgRGVmaW5lIHRoZSBzdGFydCBtYXJrZXINCiAgICAgICAgJHN0YXJ0TWFya2VyID0gJ3sicmF3TGluZXMiOlsiJw0KICAgICAgICANCiAgICAgICAgIyBGaW5kIHRoZSBwb3NpdGlvbiBvZiB0aGUgc3RhcnQgbWFya2VyDQogICAgICAgICRzdGFydFBvcyA9ICRmaWxlQ29udGVudC5JbmRleE9mKCRzdGFydE1hcmtlcikNCiAgICAgICAgaWYgKCRzdGFydFBvcyAtZXEgLTEpIHsNCiAgICAgICAgICAgIFdyaXRlLUVycm9yICJTdGFydCBtYXJrZXIgbm90IGZvdW5kIGluIHRoZSBmaWxlLiINCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAjIEZpbmQgdGhlIHBvc2l0aW9uIG9mIHRoZSBjbG9zaW5nIEpTT04gc3RydWN0dXJlDQogICAgICAgICRlbmRNYXJrZXIgPSAnIl0sJw0KICAgICAgICAkZW5kUG9zID0gJGZpbGVDb250ZW50LkluZGV4T2YoJGVuZE1hcmtlciwgJHN0YXJ0UG9zKQ0KICAgICAgICBpZiAoJGVuZFBvcyAtZXEgLTEpIHsNCiAgICAgICAgICAgIFdyaXRlLUVycm9yICJFbmQgbWFya2VyIG5vdCBmb3VuZCBpbiB0aGUgZmlsZS4iDQogICAgICAgICAgICByZXR1cm4NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgIyBFeHRyYWN0IHRoZSBKU09OIGNvbnRlbnQgaW5jbHVkaW5nIHRoZSBtYXJrZXJzDQogICAgICAgICRqc29uQ29udGVudCA9ICRmaWxlQ29udGVudC5TdWJzdHJpbmcoJHN0YXJ0UG9zLCAkZW5kUG9zIC0gJHN0YXJ0UG9zICsgJGVuZE1hcmtlci5MZW5ndGgpDQogICAgICAgICRqc29uQ29udGVudCArPSAnIicgIyBBZGQgdGhlIGNsb3NpbmcgcXVvdGUgdG8gbWFrZSBpdCB2YWxpZCBKU09ODQogICAgICAgIA0KICAgICAgICAjIEF0dGVtcHQgdG8gcGFyc2UgdGhlIEpTT04NCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICRwYXJzZWRKc29uID0gJGpzb25Db250ZW50IHwgQ29udmVydEZyb20tSnNvbg0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIEV4dHJhY3QgdGhlIGFycmF5IG9mIGxpbmVzDQogICAgICAgICAgICAkbGluZXMgPSAkcGFyc2VkSnNvbi5yYXdMaW5lcw0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIEpvaW4gdGhlIGxpbmVzIHdpdGggbmV3bGluZXMgdG8gY3JlYXRlIHByb3BlciBzY3JpcHQgY29udGVudA0KICAgICAgICAgICAgJHNhbml0aXplZENvbnRlbnQgPSAkbGluZXMgLWpvaW4gImByYG4iDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgT3V0cHV0IHJlc3VsdHMNCiAgICAgICAgICAgIGlmICgkT3V0cHV0UGF0aCkgew0KICAgICAgICAgICAgICAgICMgU2F2ZSB0byBmaWxlIGlmIG91dHB1dCBwYXRoIGlzIHByb3ZpZGVkDQogICAgICAgICAgICAgICAgJHNhbml0aXplZENvbnRlbnQgfCBPdXQtRmlsZSAtRmlsZVBhdGggJE91dHB1dFBhdGggLUVuY29kaW5nIFVURjgNCiAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJDb250ZW50IGV4dHJhY3RlZCBhbmQgc2F2ZWQgdG8gJE91dHB1dFBhdGgiDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICMgUmV0dXJuIHRoZSBleHRyYWN0ZWQgY29udGVudA0KICAgICAgICAgICAgICAgIHJldHVybiAkc2FuaXRpemVkQ29udGVudA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGNhdGNoIHsNCiAgICAgICAgICAgIFdyaXRlLUVycm9yICJGYWlsZWQgdG8gcGFyc2UgSlNPTiBjb250ZW50OiAkXyINCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBBbHRlcm5hdGl2ZSBhcHByb2FjaDogbWFudWFsIGV4dHJhY3Rpb24gaWYgSlNPTiBwYXJzaW5nIGZhaWxzDQogICAgICAgICAgICBXcml0ZS1Ib3N0ICJBdHRlbXB0aW5nIG1hbnVhbCBleHRyYWN0aW9uLi4uIg0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIEV4dHJhY3QgY29udGVudCBiZXR3ZWVuIG1hcmtlcnMgZGlyZWN0bHkNCiAgICAgICAgICAgICRjb250ZW50ID0gJGZpbGVDb250ZW50LlN1YnN0cmluZygkc3RhcnRQb3MgKyAkc3RhcnRNYXJrZXIuTGVuZ3RoLCAkZW5kUG9zIC0gJHN0YXJ0UG9zIC0gJHN0YXJ0TWFya2VyLkxlbmd0aCkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBTcGxpdCBieSB0aGUgbGluZSBzZXBhcmF0b3IgcGF0dGVybiBpbiB0aGUgSlNPTg0KICAgICAgICAgICAgJGxpbmVzID0gJGNvbnRlbnQgLXNwbGl0ICciLCInDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgQ2xlYW4gdXAgZXNjYXBlIHNlcXVlbmNlcw0KICAgICAgICAgICAgJHNhbml0aXplZExpbmVzID0gJGxpbmVzIHwgRm9yRWFjaC1PYmplY3QgeyAkXyAtcmVwbGFjZSAnXFwiJywgJyInIC1yZXBsYWNlICdcXFxcJywgJ1wnIH0NCiAgICAgICAgICAgICRzYW5pdGl6ZWRDb250ZW50ID0gJHNhbml0aXplZExpbmVzIC1qb2luICJgcmBuIg0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoJE91dHB1dFBhdGgpIHsNCiAgICAgICAgICAgICAgICAkc2FuaXRpemVkQ29udGVudCB8IE91dC1GaWxlIC1GaWxlUGF0aCAkT3V0cHV0UGF0aCAtRW5jb2RpbmcgVVRGOA0KICAgICAgICAgICAgICAgIFdyaXRlLUhvc3QgIkNvbnRlbnQgbWFudWFsbHkgZXh0cmFjdGVkIGFuZCBzYXZlZCB0byAkT3V0cHV0UGF0aCINCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICRzYW5pdGl6ZWRDb250ZW50DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgY2F0Y2ggew0KICAgICAgICBXcml0ZS1FcnJvciAiQW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIGV4dHJhY3Rpb246ICRfIg0KICAgIH0NCn0NCg0KIyBFeGFtcGxlIHVzYWdlOg0KIyBFeHRyYWN0LUpzb25Db250ZW50IC1GaWxlUGF0aCAiQzpccGF0aFx0b1x5b3VyXGZpbGUudHh0IiAtT3V0cHV0UGF0aCAiQzpccGF0aFx0b1xvdXRwdXQucHMxIg0KIyANCiMgT3IgdG8ganVzdCBnZXQgdGhlIGNvbnRlbnQgd2l0aG91dCBzYXZpbmcgdG8gZmlsZToNCiMgJGNvbnRlbnQgPSBFeHRyYWN0LUpzb25Db250ZW50IC1GaWxlUGF0aCAiQzpccGF0aFx0b1x5b3VyXGZpbGUudHh0Ig==")))
